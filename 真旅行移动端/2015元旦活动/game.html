<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Document</title>
    <link rel="stylesheet" href="../../mstatic/css/demotree.css"/>

    <!--<script src="../../mstatic/js/base/jquery.min.js"></script>
    <script src="../../mstatic/js/base/fastclick.js"></script>-->

    <script type="text/javascript">
        var root = document.getElementsByTagName("html")[0],
                w = window.innerWidth >= 750 ? 750 : window.innerWidth,
                h = window.innerHeight >= 1334 ? 1334 : window.innerHeight,
                base_ratio = 750 / 1334,
                actual_ratio = window.innerWidth / window.innerHeight;

        if (actual_ratio >= base_ratio) {  // 宽屏，按高度算

            root.style.fontSize = (h / 667) * 20 + "px";

        } else if (actual_ratio < base_ratio) {  //  长屏，按宽度算

            root.style.fontSize = (w / 375) * 20 + "px";
        }

        root.style.height = window.innerHeight + "px";

        window.onload = function(){
            /*加载页*/
            var canvas=document.getElementById('loadingcanvas');
            var ctx = canvas.getContext('2d');

            /*canvas.width=+'rem';
             canvas.height=+'rem';*/

            /*游戏说明页*/
            var getprize_list = document.getElementsByClassName('getprize_list')[0];
            var lis = document.getElementsByTagName('li');
            for(var i = 0;i < 5; i++){
                var li = document.createElement('li');
                li.innerHTML = lis[i].innerHTML;
                getprize_list.appendChild(li);
            }

            /*游戏说明页 获奖人员名单*/
            var speed = 15;
            var liheight = document.getElementsByTagName('li')[0].offsetHeight;
            var listtranslatey = 0;
            function scroll(){
                    if(listtranslatey <= (-(getprize_list.scrollHeight-getprize_list.offsetHeight-1))){
                        /*getprize_list.style.webkitTransform = 'translateY(0)';*/
                        listtranslatey = -10;
                    }else{
                        listtranslatey -- ;
                    }
                getprize_list.style.webkitTransform  = 'translate3D(0,'+listtranslatey+'px,0)';
            }
            var timer = setInterval(function(){
                scroll();
            },speed);


            /*游戏*/
            /*开始给小树施肥按钮点击*/
            var startgame = document.getElementById('startgame');
            var gamerule = document.getElementById('gamerule');
            var timeprogress = document.getElementsByClassName('timeprogress')[0];
            var time = document.getElementsByClassName('time')[0];
            var success = document.getElementById('success');
            var fail = document.getElementById('fail');
            startgame.addEventListener('click',function(){
                gamerule.style.display = 'none';
                timeprogress.style.display = 'block';
            },false);

            /*游戏中屏幕点击*/
            var leafnum = 40;
            var treebox = document.getElementById('treebox');
            for(var i=0;i< leafnum;i++){
                var spanleaf = document.createElement('span');
                spanleaf.setAttribute('class','leaf');
                treebox.appendChild(spanleaf);
                spanleaf.style.display = "none";
            }

            var flag = false;
            var clicknum=0;   //点击次数计数
            var num = 10 ;   //点击次数
            var spanleafs = document.getElementsByClassName('leaf');
            var tree = document.getElementsByClassName('tree')[0];
            var body = document.getElementsByTagName('body')[0];
            treebox.addEventListener('click',function(){
                if (clicknum < num) {
                    var treeclass = tree.className + ' big' + (clicknum + 1);
                    console.log(treeclass);
                    tree.setAttribute('class',treeclass);
                    clicknum++;
                }else{
                    console.log('叶子出现 flag=' + flag);
                    if(flag == true&&(clicknum - num+1)<=leafnum){
                        console.log(flag);

                        body.setAttribute('class','');

                        body.setAttribute('class','shake');
                        spanleafs[clicknum - num].style.display = 'inline-block';

                        spanleafs[clicknum - num].setAttribute('class','leaf leaf'+(clicknum- ( num-1 )));
                        time.innerHTML = clicknum-num+1;
                        time.style.display = 'block';
                        if(time.innerHTML == leafnum){
                            time.style.display = 'none';
                            timeprogress.style.display = 'none';
                            success.style.display = 'block';
                        }
                        /*if(timenum<0){
                            time.style.display = 'none';
                            timeprogress.style.display = 'none';
                            fail.style.display = 'block';
                        }else{
                            if(time.innerHTML == leafnum){
                                time.style.display = 'none';
                                timeprogress.style.display = 'none';
                                success.style.display = 'block';
                            }
                        }*/
                        /*if(time.innerHTML == leafnum&&timenum>=0){
                            time.style.display = 'none';
                            timeprogress.style.display = 'none';
                            success.style.display = 'block';
                        }else if(time.innerHTML != leafnum&&timenum<0){
                            time.style.display = 'none';
                            timeprogress.style.display = 'none';
                            fail.style.display = 'block';
                        }*/
                        clicknum++;
                    }
                }
            },false)

            /*游戏倒计时*/
            /*var timenum=5;
            function timeCalculation(){
                timenum--;
                *//*if(timenum<0){
                    time.style.display = 'none';
                    timeprogress.style.display = 'none';
                    fail.style.display = 'block';
                }*//*
            }
            setInterval(timeCalculation,1000);*/

            var timenum=5;
            /*var timecanvasContainer = document.getElementById('timecanvasContainer');*/
            var timecanvas = document.getElementById('timecanvas');
            var ctxtimecanvas = timecanvas.getContext('2d');

            /*console.log(timecanvasContainer.clientWidth,timecanvasContainer.clientHeight);*/
            ctxtimecanvas.width = document.getElementById('timecanvasContainer').clientWidth;
            ctxtimecanvas.height = document.getElementById('timecanvasContainer').clientHeight;

            ctxtimecanvas.beginPath();
            /*ctxtimecanvas.strokeStyle = '#333333';*/
            ctxtimecanvas.fillStyle = '#333333';
            /*ctxtimecanvas.lineWidth = ctxtimecanvas.height;*/
            ctxtimecanvas.fillRect(0,0,ctxtimecanvas.width,ctxtimecanvas.height);
           /* ctxtimecanvas.moveTo(0,0);
            ctxtimecanvas.lineTo(ctxtimecanvas.width,0);*/
            ctxtimecanvas.fill();/*ctxtimecanvas.stroke();*/
            ctxtimecanvas.closePath();
            /*function timeCalculation(){
                timenum--;
                if(timenum<0){
                    time.style.display = 'none';
                    timeprogress.style.display = 'none';
                    fail.style.display = 'block';
                }
            }
            setInterval(timeCalculation,1000);*/

            body.addEventListener("webkitTransitionEnd", function(e) {
//                alert('123');
                flag = true;



                if (body.className="shake") {
                    body.setAttribute('class','');
                }
            },false);

            var egg = document.getElementById('egg');
            var success_noprize = document.getElementById('success_noprize');
            egg.addEventListener('click',function(){
                setTimeout(function(){
                    success.style.display = 'none';
                    success_noprize.style.display = 'block';
                },1000);
            },false);

            var playgamebtn = document.getElementsByClassName('playgamebtn')[0];
            var gameDescribe = document.getElementsByClassName('gameDescribe')[0];
            var game = document.getElementsByClassName('game')[0];
            playgamebtn.addEventListener('click',function(){
                gameDescribe.style.display = 'none';
                game.style.display = 'block';
            },false);

        }
    </script>
</head>
<body class="redbg">
    <div class="loading" style="display:none;">
        <img class="loadingpagebg" src="../../mstatic/images/activity/loadingpagebg.png" alt=""/>
        <div class="loadingprogress">
            <canvas id="loadingcanvas"></canvas>
            <img class="lodingtext" src="../../mstatic/images/activity/loading.png" alt=""/>
        </div>
    </div>
    <div class="gameDescribe" style="display:blcok;">
        <span class="avater"></span>
        <div class="game_describe"></div>
        <div class="getprize_list_contain">
            <ul class="getprize_list">
                <li>
                    <div class="user_getprize">
                        <span class="avater_user_getprize"></span><br/>
                        <span class="name_user_getprize">昵称1。。。。</span>
                    </div>
                    <span class="prize_kinds_calender"></span>
                </li>
                <li>
                    <div class="user_getprize">
                        <span class="avater_user_getprize"></span><br/>
                        <span class="name_user_getprize">2fasfdddddddddddasdfasf。。。</span>
                    </div>
                    <span class="prize_kinds_bag"></span>
                </li>
                <li>
                    <div class="user_getprize">
                        <span class="avater_user_getprize"></span><br/>
                        <span class="name_user_getprize">31333333333324123。。。。</span>
                    </div>
                    <span class="prize_kinds_voucher"></span>
                </li>
                <li>
                    <div class="user_getprize">
                        <span class="avater_user_getprize"></span><br/>
                        <span class="name_user_getprize">4昵称昵称昵称</span>
                    </div>
                    <span class="prize_kinds_calender"></span>
                </li>
                <li>
                    <div class="user_getprize">
                        <span class="avater_user_getprize"></span><br/>
                        <span class="name_user_getprize">5蓝天</span>
                    </div>
                    <span class="prize_kinds_bag"></span>
                </li>
                <li>
                    <div class="user_getprize">
                        <span class="avater_user_getprize"></span><br/>
                        <span class="name_user_getprize">6rale。。。。</span>
                    </div>
                    <span class="prize_kinds_voucher"></span>
                </li><li>
                    <div class="user_getprize">
                        <span class="avater_user_getprize"></span><br/>
                        <span class="name_user_getprize">昵称昵称昵称</span>
                    </div>
                    <span class="prize_kinds_calender"></span>
                </li>
                <li>
                    <div class="user_getprize">
                        <span class="avater_user_getprize"></span><br/>
                        <span class="name_user_getprize">昵称。。。。</span>
                    </div>
                    <span class="prize_kinds_bag"></span>
                </li>
                <li>
                    <div class="user_getprize">
                        <span class="avater_user_getprize"></span><br/>
                        <span class="name_user_getprize">昵称。。。。</span>
                    </div>
                    <span class="prize_kinds_voucher"></span>
                </li>
            </ul>
        </div>
        <div class="playgame">
            <!--<div class="playgamebtnbg"></div>-->
            <a class="playgamebtn" href="javascript:void(0);"></a>
        </div>
    </div>
    <div class="game" style="display:none;">
        <div id="treebox" class="gamebg">
            <span class="time" style="display:none;">23</span>
            <div class="timeprogress" style="display:none;">
                <img class="timetext" src="../../mstatic/images/activity/surplus.png" alt=""/>
                <div id="timecanvasContainer">
                    <span id="timecanvas"></span>
                </div>
            </div>
            <span class="tree"></span>
        </div>
        <div id="gamerule" style="display:block;">
            <img class="rule" src="../../mstatic/images/activity/gamerule.png" alt=""/><br/>
            <a id="startgame" href="javascript:void(0);"></a>
        </div>
        <div id="success" style="display:none;">
            <img id="egg" src="../../mstatic/images/activity/egg.png" alt=""/><br/>
            <span class="takeprize"></span>
        </div>
        <div id="success_noprize" style="display:none;">
            <span class="noprize_text"></span>
            <span class="noprize_qr"></span>
        </div>
        <div id="success_takedprize" style="display:none;">
            <span class="takedprize_text"></span>
            <div class="getprizeBtn">
                <a class="replay_btn" href="javascript:void(0);"></a><br/>
                <a class="other_getprize_btn" href="javascript:void(0);"></a>
            </div>
        </div>
        <div id="fail" style="display:none;">
            <span class="fail_text"></span>
            <div class="getprizeBtn">
                <a class="replay_btn" href="javascript:void(0);"></a><br/>
                <a class="other_getprize_btn" href="javascript:void(0);"></a>
            </div>
        </div>
        <div id="tooManyPeople" style="display:none;">
            <span class="manypeople_text"></span>
            <div class="getprizeBtn">
                <a class="replay_btn" href="javascript:void(0);"></a><br/>
                <a class="other_getprize_btn" href="javascript:void(0);"></a>
            </div>
        </div>

    </div>
</body>
</html>