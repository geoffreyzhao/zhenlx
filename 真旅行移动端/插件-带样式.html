<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="format-detection" content="telephone=no, email=no">
	<link rel="stylesheet" type="text/css" href="../../mstatic/css/jqm/jquery.mobile-1.4.5.min.css">
	<link rel="stylesheet" type="text/css" href="../../mstatic/css/jqm/jquery.mobile.theme-1.4.5.css">
	<link rel="stylesheet" type="text/css" href="../../mstatic/css/jqm.reset.css">
	<link rel="stylesheet" type="text/css" href="../../mstatic/css/common.css">
	<script type="text/javascript" src="../../mstatic/js/base/jquery.min.js"></script>
	<script type="text/javascript" src="../../mstatic/js/jqm/jquery.mobile-1.4.5.min.js"></script>
	<script type="text/javascript" src="../../mstatic/js/vendor/underscore.js"></script>
	<script type="text/javascript" src="../../mstatic/js/iscroll/iscroll.js"></script>
	<script type="text/javascript" src="../../mstatic/js/vendor/datepicker-scroll.js"></script>
	<script type="text/javascript" src="../../mstatic/js/vendor/addresspicker-scroll.js"></script>
	<script type="text/javascript" src="../../mstatic/js/vendor/cus-list-pop.js"></script>
	<script type="text/javascript" src="../../mstatic/js/base/fastclick.js"></script>
    <script type="text/javascript" src="../../mstatic/js/common.js"></script>
	<title>插件--带样式</title>

	<script type="text/javascript">
		var root = document.getElementsByTagName("html")[0],
			w = window.innerWidth >= 640 ? 640 : window.innerWidth;

		root.style.fontSize = (w / 320) * 20 + "px";
		root.style.minHeight = window.innerHeight + "px";
	</script>
</head>
<body>
	<div data-role="page">

		<div id="sexType">性别</div>

		<div id="cardType">证件类型</div>

		<div id="travellerInfo">动态加载（延时模拟）常旅客</div>

		<div id="birthdate">点击选择日期</div>

		<div id="address">点击选择地址</div>

		<div data-role="popup" data-theme="a" data-overlay-theme="b" data-transition="slideup" data-position-to="window" data-corners="false" data-dismissible="false" style="height:10.25rem;">
			<div class="addresspicker-top-block">
				<div class="dp-cancel-btn">取消</div>
				<div class="title">请选择城市</div>
				<div class="dp-sure-btn">确定</div>
			</div>
			<div id="addressWrapperContainer" class="addresspicker-scroll"></div>
		</div>
	</div>

<script type="text/javascript">

	$(function(){

		FastClick.attach(document.body);

		//  弹窗弹出，禁止页面滚动，待放入 common.js

		// $("div[data-role='popup']").popup({
  //           afteropen: function(){
  //               $(".ui-popup-screen").bind("touchmove", function(){  //  弹窗遮罩层禁止滑动
  //                   return false;
  //               });

  //               $(".pop-select-title").bind("touchmove", function(){
  //                   return false;
  //               });
  //           }
  //       });

        var province = ["上海市", "北京市", "安徽省", "江苏省", "浙江省"];

        var city = [{
        	parent: "上海市",
        	children: ['上海市']
        }, {
        	parent: "北京市",
        	children: ['北京市']
        }, {
        	parent: "安徽省",
        	children: ['安徽市1', '安徽市2', '安徽市3', '安徽市4', '安徽市5']
        }, {
        	parent: "江苏省",
        	children: ['江苏市1', '江苏市2', '江苏市3', '江苏市4', '江苏市5']
        }, {
        	parent: "浙江省",
        	children: ['浙江市1', '浙江市2', '浙江市3', '浙江市4', '浙江市5']
        }];

        var county = [{
        	parent: "上海市",
        	children: ['宝山区', '闸北区', '浦东区', '杨浦区', '黄浦区']
        }, {
        	parent: "北京市",
        	children: ['朝阳区']
        }, {
        	parent: "安徽市1",
        	children: ['安徽县1', '安徽县2', '安徽县3', '安徽县4']
        },{
        	parent: "安徽市2",
        	children: ['安徽县21', '安徽县22', '安徽县23', '安徽县24']
        }, {
        	parent: "江苏市1",
        	children: ['江苏县']
        }, {
        	parent: "浙江市1",
        	children: ['浙江县']
        }];

        sessionStorage.clear();
        sessionStorage.setItem("province", JSON.stringify(province));
        sessionStorage.setItem("city", JSON.stringify(city));
        sessionStorage.setItem("county", JSON.stringify(county));

        var address_1 = new AddressPicker("#addressWrapperContainer", {
        	currentAddress: ["北京市", "北京市", "朝阳区"]
        }).init();

        console.log(address_1.getAddress());

        address_1.setAddress(["上海市", "上海市", "闸北区"]);

        $("#address").click(function(){
        	$("#addressWrapperContainer").closest("div[data-role='popup']").popup("open");
        });

        $("#sexType").click(function(){
        	$(this).cusListPop({
        		title: "请选择性别",
        		scrollId: "sexType",
        		data: ["男", "女"],
        		currentData: '女'
        	});
        });

        $("#cardType").click(function(){
        	$(this).cusListPop({
        		title: "请选择证件类型",
        		scrollId: "cardTypeWrapper",
        		data: [{
        			name: "身份证",
                    id: 1
        		}, {
        			name: "护照",
                    id: 2
        		}, {
        			name: "港澳通行证",
                    id: 3
        		}, {
        			name: "士官证",
                    id: 4
        		}, {
        			name: "其他",
                    id: 5
        		}],
        		currentData: {
        			name: "士官证",
                    id: 4
        		},
                // reCreate: true,
        		callback: function() {
        			//  可绑定弹窗上元素的事件操作
        		}
        	});
        });


        $("#travellerInfo").click(function(){

        	var $this = $(this);

        	//  用延时模拟发送请求回执的时间
        	//  实际情况是：在ajax success回调方法中调用cusListPop方法，数据参数传给data
        	setTimeout(function(){
        		$this.cusListPop({
        			title: "请选择常旅客",  //  默认值：请选择
					scrollId: "travellerInfoWrapper",  //  id 必填且唯一
					data: [{
						name: "常旅客1"
					}, {
						name: "常旅客2"
					}, {
						name: "常旅客3"
					}, {
						name: "常旅客4"
					}, {
						name: "常旅客5"
					},{
						name: "常旅客6"
					}, {
						name: "常旅客7"
					}, {
						name: "常旅客8"
					}, {
						name: "常旅客9"
					}, {
						name: "常旅客10"
					}]
        		});
        	}, 500);
        });

        var dp = new DatepickerScroll("#birthdate", {
        	startYear: 1900,
			endYear: 2015,
			defaultDate: new Date(1980,0,1),
			cancelCallback: function(){
				console.log(1);
			},
			confirmCallback: function() {
				console.log(2);
			}
        }).init();

        $("#birthdate").click(function(){
        	// dp.setDate(new Date(1990,5,12));
            dp.setDate(new Date());
        	$("#birthdateDatepicker").popup("open");
        });

        // dp.setDate(new Date());   设置时间
        // dp.getDate();  //  获取时间
        
	});

</script>
</body>
</html>